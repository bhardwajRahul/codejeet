{
  "id": "3030",
  "title": "Find the Grid of Region Average",
  "slug": "find-the-grid-of-region-average",
  "difficulty": "Medium",
  "category": "Algorithms",
  "content_html": "<p>You are given <code>m x n</code> grid <code>image</code> which represents a grayscale image, where <code>image[i][j]</code> represents a pixel with intensity in the range <code>[0..255]</code>. You are also given a <strong>non-negative</strong> integer <code>threshold</code>.</p>\n\n<p>Two pixels are <strong>adjacent</strong> if they share an edge.</p>\n\n<p>A <strong>region</strong> is a <code>3 x 3</code> subgrid where the <strong>absolute difference</strong> in intensity between any two <strong>adjacent</strong> pixels is <strong>less than or equal to</strong> <code>threshold</code>.</p>\n\n<p>All pixels in a region belong to that region, note that a pixel can belong to <strong>multiple</strong> regions.</p>\n\n<p>You need to calculate a <code>m x n</code> grid <code>result</code>, where <code>result[i][j]</code> is the <strong>average</strong> intensity of the regions to which <code>image[i][j]</code> belongs, <strong>rounded down</strong> to the nearest integer. If <code>image[i][j]</code> belongs to multiple regions, <code>result[i][j]</code> is the <strong>average </strong>of the<strong> rounded-down average </strong>intensities of these regions, <strong>rounded down</strong> to the nearest integer. If <code>image[i][j]</code> does<strong> not</strong> belong to any region, <code>result[i][j]</code> is <strong>equal to</strong> <code>image[i][j]</code>.</p>\n\n<p>Return the grid <code>result</code>.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">image = [[5,6,7,10],[8,9,10,10],[11,12,13,10]], threshold = 3</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">[[9,9,9,9],[9,9,9,9],[9,9,9,9]]</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p><img alt=\"\" src=\"https://assets.leetcode.com/uploads/2023/12/21/example0corrected.png\" style=\"width: 832px; height: 275px;\" /></p>\n\n<p>There are two regions as illustrated above. The average intensity of the first region is 9, while the average intensity of the second region is 9.67 which is rounded down to 9. The average intensity of both of the regions is (9 + 9) / 2 = 9. As all the pixels belong to either region 1, region 2, or both of them, the intensity of every pixel in the result is 9.</p>\n\n<p>Please note that the rounded-down values are used when calculating the average of multiple regions, hence the calculation is done using 9 as the average intensity of region 2, not 9.67.</p>\n</div>\n\n<p><strong class=\"example\">Example 2:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">image = [[10,20,30],[15,25,35],[20,30,40],[25,35,45]], threshold = 12</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">[[25,25,25],[27,27,27],[27,27,27],[30,30,30]]</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p><img src=\"https://assets.leetcode.com/uploads/2023/12/21/example1corrected.png\" /></p>\n\n<p>There are two regions as illustrated above. The average intensity of the first region is 25, while the average intensity of the second region is 30. The average intensity of both of the regions is (25 + 30) / 2 = 27.5 which is rounded down to 27.</p>\n\n<p>All the pixels in row 0 of the image belong to region 1, hence all the pixels in row 0 in the result are 25. Similarly, all the pixels in row 3 in the result are 30. The pixels in rows 1 and 2 of the image belong to region 1 and region 2, hence their assigned value is 27 in the result.</p>\n</div>\n\n<p><strong class=\"example\">Example 3:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">image = [[5,6,7],[8,9,10],[11,12,13]], threshold = 1</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">[[5,6,7],[8,9,10],[11,12,13]]</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>There is only one <code>3 x 3</code> subgrid, while it does not have the condition on difference of adjacent pixels, for example, the difference between <code>image[0][0]</code> and <code>image[1][0]</code> is <code>|5 - 8| = 3 &gt; threshold = 1</code>. None of them belong to any valid regions, so the <code>result</code> should be the same as <code>image</code>.</p>\n</div>\n\n<p>&nbsp;</p>\n<p><strong>Constraints:</strong></p>\n\n<ul>\n\t<li><code>3 &lt;= n, m &lt;= 500</code></li>\n\t<li><code>0 &lt;= image[i][j] &lt;= 255</code></li>\n\t<li><code>0 &lt;= threshold &lt;= 255</code></li>\n</ul>\n",
  "content_markdown": "You are given `m x n` grid `image` which represents a grayscale image, where `image[i][j]` represents a pixel with intensity in the range `[0..255]`. You are also given a **non-negative** integer `threshold`.\n\nTwo pixels are **adjacent** if they share an edge.\n\nA **region** is a `3 x 3` subgrid where the **absolute difference** in intensity between any two **adjacent** pixels is **less than or equal to** `threshold`.\n\nAll pixels in a region belong to that region, note that a pixel can belong to **multiple** regions.\n\nYou need to calculate a `m x n` grid `result`, where `result[i][j]` is the **average** intensity of the regions to which `image[i][j]` belongs, **rounded down** to the nearest integer. If `image[i][j]` belongs to multiple regions, `result[i][j]` is the **average** of the**rounded-down average** intensities of these regions, **rounded down** to the nearest integer. If `image[i][j]` does**not** belong to any region, `result[i][j]` is **equal to** `image[i][j]`.\n\nReturn the grid `result`.\n\n \n\n**Example 1:**\n\n**Input:** image = [[5,6,7,10],[8,9,10,10],[11,12,13,10]], threshold = 3\n\n**Output:** [[9,9,9,9],[9,9,9,9],[9,9,9,9]]\n\n**Explanation:**\n\n![](https://assets.leetcode.com/uploads/2023/12/21/example0corrected.png)\n\nThere are two regions as illustrated above. The average intensity of the first region is 9, while the average intensity of the second region is 9.67 which is rounded down to 9. The average intensity of both of the regions is (9 + 9) / 2 = 9. As all the pixels belong to either region 1, region 2, or both of them, the intensity of every pixel in the result is 9.\n\nPlease note that the rounded-down values are used when calculating the average of multiple regions, hence the calculation is done using 9 as the average intensity of region 2, not 9.67.\n\n**Example 2:**\n\n**Input:** image = [[10,20,30],[15,25,35],[20,30,40],[25,35,45]], threshold = 12\n\n**Output:** [[25,25,25],[27,27,27],[27,27,27],[30,30,30]]\n\n**Explanation:**\n\n![](https://assets.leetcode.com/uploads/2023/12/21/example1corrected.png)\n\nThere are two regions as illustrated above. The average intensity of the first region is 25, while the average intensity of the second region is 30. The average intensity of both of the regions is (25 + 30) / 2 = 27.5 which is rounded down to 27.\n\nAll the pixels in row 0 of the image belong to region 1, hence all the pixels in row 0 in the result are 25. Similarly, all the pixels in row 3 in the result are 30. The pixels in rows 1 and 2 of the image belong to region 1 and region 2, hence their assigned value is 27 in the result.\n\n**Example 3:**\n\n**Input:** image = [[5,6,7],[8,9,10],[11,12,13]], threshold = 1\n\n**Output:** [[5,6,7],[8,9,10],[11,12,13]]\n\n**Explanation:**\n\nThere is only one `3 x 3` subgrid, while it does not have the condition on difference of adjacent pixels, for example, the difference between `image[0][0]` and `image[1][0]` is `|5 - 8| = 3 > threshold = 1`. None of them belong to any valid regions, so the `result` should be the same as `image`.\n\n \n\n**Constraints:**\n\n  * `3 <= n, m <= 500`\n  * `0 <= image[i][j] <= 255`\n  * `0 <= threshold <= 255`",
  "question": "You are given `m x n` grid `image` which represents a grayscale image, where `image[i][j]` represents a pixel with intensity in the range `[0..255]`. You are also given a **non-negative** integer `threshold`.\n\nTwo pixels are **adjacent** if they share an edge.\n\nA **region** is a `3 x 3` subgrid where the **absolute difference** in intensity between any two **adjacent** pixels is **less than or equal to** `threshold`.\n\nAll pixels in a region belong to that region, note that a pixel can belong to **multiple** regions.\n\nYou need to calculate a `m x n` grid `result`, where `result[i][j]` is the **average** intensity of the regions to which `image[i][j]` belongs, **rounded down** to the nearest integer. If `image[i][j]` belongs to multiple regions, `result[i][j]` is the **average** of the**rounded-down average** intensities of these regions, **rounded down** to the nearest integer. If `image[i][j]` does**not** belong to any region, `result[i][j]` is **equal to** `image[i][j]`.\n\nReturn the grid `result`.",
  "examples": "**Example 1:**\n\n**Input:** image = [[5,6,7,10],[8,9,10,10],[11,12,13,10]], threshold = 3\n\n**Output:** [[9,9,9,9],[9,9,9,9],[9,9,9,9]]\n\n**Explanation:**\n\n![](https://assets.leetcode.com/uploads/2023/12/21/example0corrected.png)\n\nThere are two regions as illustrated above. The average intensity of the first region is 9, while the average intensity of the second region is 9.67 which is rounded down to 9. The average intensity of both of the regions is (9 + 9) / 2 = 9. As all the pixels belong to either region 1, region 2, or both of them, the intensity of every pixel in the result is 9.\n\nPlease note that the rounded-down values are used when calculating the average of multiple regions, hence the calculation is done using 9 as the average intensity of region 2, not 9.67.\n\n**Example 2:**\n\n**Input:** image = [[10,20,30],[15,25,35],[20,30,40],[25,35,45]], threshold = 12\n\n**Output:** [[25,25,25],[27,27,27],[27,27,27],[30,30,30]]\n\n**Explanation:**\n\n![](https://assets.leetcode.com/uploads/2023/12/21/example1corrected.png)\n\nThere are two regions as illustrated above. The average intensity of the first region is 25, while the average intensity of the second region is 30. The average intensity of both of the regions is (25 + 30) / 2 = 27.5 which is rounded down to 27.\n\nAll the pixels in row 0 of the image belong to region 1, hence all the pixels in row 0 in the result are 25. Similarly, all the pixels in row 3 in the result are 30. The pixels in rows 1 and 2 of the image belong to region 1 and region 2, hence their assigned value is 27 in the result.\n\n**Example 3:**\n\n**Input:** image = [[5,6,7],[8,9,10],[11,12,13]], threshold = 1\n\n**Output:** [[5,6,7],[8,9,10],[11,12,13]]\n\n**Explanation:**\n\nThere is only one `3 x 3` subgrid, while it does not have the condition on difference of adjacent pixels, for example, the difference between `image[0][0]` and `image[1][0]` is `|5 - 8| = 3 > threshold = 1`. None of them belong to any valid regions, so the `result` should be the same as `image`.",
  "constraints": "**Constraints:**\n\n  * `3 <= n, m <= 500`\n  * `0 <= image[i][j] <= 255`\n  * `0 <= threshold <= 255`",
  "topics": ["Array", "Matrix"],
  "total_accepted": 11935,
  "total_submissions": 27594,
  "acceptance_rate": "43.3%",
  "similar_questions": [
    {
      "title": "Range Sum Query 2D - Immutable",
      "slug": "range-sum-query-2d-immutable",
      "difficulty": "Medium",
      "url": "https://leetcode.com/problems/range-sum-query-2d-immutable/"
    },
    {
      "title": "K Radius Subarray Averages",
      "slug": "k-radius-subarray-averages",
      "difficulty": "Medium",
      "url": "https://leetcode.com/problems/k-radius-subarray-averages/"
    }
  ],
  "hints": [
    "Try all the <code>3 * 3</code> sub-grids to find all the regions.",
    "Keep two 2-D arrays <code>sum</code> and <code>num</code>, for each position <code>(x, y)</code> in a region, increase <code>sum[x][y]</code> by the average sum of the region and increase <code>num[x][y]</code> by <code>1</code>.",
    "For each position (x, y), <code>sum[x][y] / num[x][y]</code> is the answer. Note when <code>num[x][y] == 0</code>, we use the original value in <code>image</code> instead."
  ]
}
