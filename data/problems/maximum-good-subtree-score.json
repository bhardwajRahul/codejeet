{
  "id": "3575",
  "title": "Maximum Good Subtree Score",
  "slug": "maximum-good-subtree-score",
  "difficulty": "Hard",
  "category": "Algorithms",
  "content_html": "<p>You are given an undirected tree rooted at node 0 with <code>n</code> nodes numbered from 0 to <code>n - 1</code>. Each node <code>i</code> has an integer value <code>vals[i]</code>, and its parent is given by <code>par[i]</code>.</p>\n\n<p>A <strong>subset</strong> of nodes within the <strong>subtree</strong> of a node is called <strong>good</strong> if every digit from 0 to 9 appears <strong>at most</strong> once in the decimal representation of the values of the selected nodes.</p>\n\n<p>The <strong>score</strong> of a good subset is the sum of the values of its nodes.</p>\n\n<p>Define an array <code>maxScore</code> of length <code>n</code>, where <code>maxScore[u]</code> represents the <strong>maximum</strong> possible sum of values of a good subset of nodes that belong to the subtree rooted at node <code>u</code>, including <code>u</code> itself and all its descendants.</p>\n\n<p>Return the sum of all values in <code>maxScore</code>.</p>\n\n<p>Since the answer may be large, return it <strong>modulo</strong> <code>10<sup>9</sup> + 7</code>.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">vals = [2,3], par = [-1,0]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">8</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p><img alt=\"\" src=\"https://assets.leetcode.com/uploads/2025/04/29/screenshot-2025-04-29-at-150754.png\" style=\"height: 84px; width: 180px;\" /></p>\n\n<ul>\n\t<li>The subtree rooted at node 0 includes nodes <code>{0, 1}</code>. The subset <code>{2, 3}</code> is<i> </i>good as the digits 2 and 3 appear only once. The score of this subset is <code>2 + 3 = 5</code>.</li>\n\t<li>The subtree rooted at node 1 includes only node <code>{1}</code>. The subset <code>{3}</code> is<i> </i>good. The score of this subset is 3.</li>\n\t<li>The <code>maxScore</code> array is <code>[5, 3]</code>, and the sum of all values in <code>maxScore</code> is <code>5 + 3 = 8</code>. Thus, the answer is 8.</li>\n</ul>\n</div>\n\n<p><strong class=\"example\">Example 2:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">vals = [1,5,2], par = [-1,0,0]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">15</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p><strong><img alt=\"\" src=\"https://assets.leetcode.com/uploads/2025/04/29/screenshot-2025-04-29-at-151408.png\" style=\"width: 205px; height: 140px;\" /></strong></p>\n\n<ul>\n\t<li>The subtree rooted at node 0 includes nodes <code>{0, 1, 2}</code>. The subset <code>{1, 5, 2}</code> is<i> </i>good as the digits 1, 5 and 2 appear only once. The score of this subset is <code>1 + 5 + 2 = 8</code>.</li>\n\t<li>The subtree rooted at node 1 includes only node <code>{1}</code>. The subset <code>{5}</code> is<i> </i>good. The score of this subset is 5.</li>\n\t<li>The subtree rooted at node 2 includes only node <code>{2}</code>. The subset <code>{2}</code> is<i> </i>good. The score of this subset is 2.</li>\n\t<li>The <code>maxScore</code> array is <code>[8, 5, 2]</code>, and the sum of all values in <code>maxScore</code> is <code>8 + 5 + 2 = 15</code>. Thus, the answer is 15.</li>\n</ul>\n</div>\n\n<p><strong class=\"example\">Example 3:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">vals = [34,1,2], par = [-1,0,1]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">42</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p><img alt=\"\" src=\"https://assets.leetcode.com/uploads/2025/04/29/screenshot-2025-04-29-at-151747.png\" style=\"height: 80px; width: 256px;\" /></p>\n\n<ul>\n\t<li>The subtree rooted at node 0 includes nodes <code>{0, 1, 2}</code>. The subset <code>{34, 1, 2}</code> is<i> </i>good as the digits 3, 4, 1 and 2 appear only once. The score of this subset is <code>34 + 1 + 2 = 37</code>.</li>\n\t<li>The subtree rooted at node 1 includes node <code>{1, 2}</code>. The subset <code>{1, 2}</code> is<i> </i>good as the digits 1 and 2 appear only once. The score of this subset is <code>1 + 2 = 3</code>.</li>\n\t<li>The subtree rooted at node 2 includes only node <code>{2}</code>. The subset <code>{2}</code> is<i> </i>good. The score of this subset is 2.</li>\n\t<li>The <code>maxScore</code> array is <code>[37, 3, 2]</code>, and the sum of all values in <code>maxScore</code> is <code>37 + 3 + 2 = 42</code>. Thus, the answer is 42.</li>\n</ul>\n</div>\n\n<p><strong class=\"example\">Example 4:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">vals = [3,22,5], par = [-1,0,1]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">18</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>The subtree rooted at node 0 includes nodes <code>{0, 1, 2}</code>. The subset <code>{3, 22, 5}</code> is<i> </i>not good, as digit 2 appears twice. Therefore, the subset <code>{3, 5}</code> is valid. The score of this subset is <code>3 + 5 = 8</code>.</li>\n\t<li>The subtree rooted at node 1 includes nodes <code>{1, 2}</code>. The subset <code>{22, 5}</code> is<i> </i>not good, as digit 2 appears twice. Therefore, the subset <code>{5}</code> is valid. The score of this subset is 5.</li>\n\t<li>The subtree rooted at node 2 includes <code>{2}</code>. The subset <code>{5}</code> is<i> </i>good. The score of this subset is 5.</li>\n\t<li>The <code>maxScore</code> array is <code>[8, 5, 5]</code>, and the sum of all values in <code>maxScore</code> is <code>8 + 5 + 5 = 18</code>. Thus, the answer is 18.</li>\n</ul>\n\n<ul>\n</ul>\n</div>\n\n<p>&nbsp;</p>\n<p><strong>Constraints:</strong></p>\n\n<ul>\n\t<li><code>1 &lt;= n == vals.length &lt;= 500</code></li>\n\t<li><code>1 &lt;= vals[i] &lt;= 10<sup>9</sup></code></li>\n\t<li><code>par.length == n</code></li>\n\t<li><code>par[0] == -1</code></li>\n\t<li><code>0 &lt;= par[i] &lt; n</code> for <code>i</code> in <code>[1, n - 1]</code></li>\n\t<li>The input is generated such that the parent array <code>par</code> represents a valid tree.</li>\n</ul>\n",
  "content_markdown": "You are given an undirected tree rooted at node 0 with `n` nodes numbered from 0 to `n - 1`. Each node `i` has an integer value `vals[i]`, and its parent is given by `par[i]`.\n\nA **subset** of nodes within the **subtree** of a node is called **good** if every digit from 0 to 9 appears **at most** once in the decimal representation of the values of the selected nodes.\n\nThe **score** of a good subset is the sum of the values of its nodes.\n\nDefine an array `maxScore` of length `n`, where `maxScore[u]` represents the **maximum** possible sum of values of a good subset of nodes that belong to the subtree rooted at node `u`, including `u` itself and all its descendants.\n\nReturn the sum of all values in `maxScore`.\n\nSince the answer may be large, return it **modulo** `109 + 7`.\n\n \n\n**Example 1:**\n\n**Input:** vals = [2,3], par = [-1,0]\n\n**Output:** 8\n\n**Explanation:**\n\n![](https://assets.leetcode.com/uploads/2025/04/29/screenshot-2025-04-29-at-150754.png)\n\n  * The subtree rooted at node 0 includes nodes `{0, 1}`. The subset `{2, 3}` is __ good as the digits 2 and 3 appear only once. The score of this subset is `2 + 3 = 5`.\n  * The subtree rooted at node 1 includes only node `{1}`. The subset `{3}` is __ good. The score of this subset is 3.\n  * The `maxScore` array is `[5, 3]`, and the sum of all values in `maxScore` is `5 + 3 = 8`. Thus, the answer is 8.\n\n\n\n**Example 2:**\n\n**Input:** vals = [1,5,2], par = [-1,0,0]\n\n**Output:** 15\n\n**Explanation:**\n\n**![](https://assets.leetcode.com/uploads/2025/04/29/screenshot-2025-04-29-at-151408.png)**\n\n  * The subtree rooted at node 0 includes nodes `{0, 1, 2}`. The subset `{1, 5, 2}` is __ good as the digits 1, 5 and 2 appear only once. The score of this subset is `1 + 5 + 2 = 8`.\n  * The subtree rooted at node 1 includes only node `{1}`. The subset `{5}` is __ good. The score of this subset is 5.\n  * The subtree rooted at node 2 includes only node `{2}`. The subset `{2}` is __ good. The score of this subset is 2.\n  * The `maxScore` array is `[8, 5, 2]`, and the sum of all values in `maxScore` is `8 + 5 + 2 = 15`. Thus, the answer is 15.\n\n\n\n**Example 3:**\n\n**Input:** vals = [34,1,2], par = [-1,0,1]\n\n**Output:** 42\n\n**Explanation:**\n\n![](https://assets.leetcode.com/uploads/2025/04/29/screenshot-2025-04-29-at-151747.png)\n\n  * The subtree rooted at node 0 includes nodes `{0, 1, 2}`. The subset `{34, 1, 2}` is __ good as the digits 3, 4, 1 and 2 appear only once. The score of this subset is `34 + 1 + 2 = 37`.\n  * The subtree rooted at node 1 includes node `{1, 2}`. The subset `{1, 2}` is __ good as the digits 1 and 2 appear only once. The score of this subset is `1 + 2 = 3`.\n  * The subtree rooted at node 2 includes only node `{2}`. The subset `{2}` is __ good. The score of this subset is 2.\n  * The `maxScore` array is `[37, 3, 2]`, and the sum of all values in `maxScore` is `37 + 3 + 2 = 42`. Thus, the answer is 42.\n\n\n\n**Example 4:**\n\n**Input:** vals = [3,22,5], par = [-1,0,1]\n\n**Output:** 18\n\n**Explanation:**\n\n  * The subtree rooted at node 0 includes nodes `{0, 1, 2}`. The subset `{3, 22, 5}` is __ not good, as digit 2 appears twice. Therefore, the subset `{3, 5}` is valid. The score of this subset is `3 + 5 = 8`.\n  * The subtree rooted at node 1 includes nodes `{1, 2}`. The subset `{22, 5}` is __ not good, as digit 2 appears twice. Therefore, the subset `{5}` is valid. The score of this subset is 5.\n  * The subtree rooted at node 2 includes `{2}`. The subset `{5}` is __ good. The score of this subset is 5.\n  * The `maxScore` array is `[8, 5, 5]`, and the sum of all values in `maxScore` is `8 + 5 + 5 = 18`. Thus, the answer is 18.\n\n\n\n\n \n\n**Constraints:**\n\n  * `1 <= n == vals.length <= 500`\n  * `1 <= vals[i] <= 109`\n  * `par.length == n`\n  * `par[0] == -1`\n  * `0 <= par[i] < n` for `i` in `[1, n - 1]`\n  * The input is generated such that the parent array `par` represents a valid tree.",
  "question": "You are given an undirected tree rooted at node 0 with `n` nodes numbered from 0 to `n - 1`. Each node `i` has an integer value `vals[i]`, and its parent is given by `par[i]`.\n\nA **subset** of nodes within the **subtree** of a node is called **good** if every digit from 0 to 9 appears **at most** once in the decimal representation of the values of the selected nodes.\n\nThe **score** of a good subset is the sum of the values of its nodes.\n\nDefine an array `maxScore` of length `n`, where `maxScore[u]` represents the **maximum** possible sum of values of a good subset of nodes that belong to the subtree rooted at node `u`, including `u` itself and all its descendants.\n\nReturn the sum of all values in `maxScore`.\n\nSince the answer may be large, return it **modulo** `109 + 7`.",
  "examples": "**Example 1:**\n\n**Input:** vals = [2,3], par = [-1,0]\n\n**Output:** 8\n\n**Explanation:**\n\n![](https://assets.leetcode.com/uploads/2025/04/29/screenshot-2025-04-29-at-150754.png)\n\n  * The subtree rooted at node 0 includes nodes `{0, 1}`. The subset `{2, 3}` is __ good as the digits 2 and 3 appear only once. The score of this subset is `2 + 3 = 5`.\n  * The subtree rooted at node 1 includes only node `{1}`. The subset `{3}` is __ good. The score of this subset is 3.\n  * The `maxScore` array is `[5, 3]`, and the sum of all values in `maxScore` is `5 + 3 = 8`. Thus, the answer is 8.\n\n\n\n**Example 2:**\n\n**Input:** vals = [1,5,2], par = [-1,0,0]\n\n**Output:** 15\n\n**Explanation:**\n\n**![](https://assets.leetcode.com/uploads/2025/04/29/screenshot-2025-04-29-at-151408.png)**\n\n  * The subtree rooted at node 0 includes nodes `{0, 1, 2}`. The subset `{1, 5, 2}` is __ good as the digits 1, 5 and 2 appear only once. The score of this subset is `1 + 5 + 2 = 8`.\n  * The subtree rooted at node 1 includes only node `{1}`. The subset `{5}` is __ good. The score of this subset is 5.\n  * The subtree rooted at node 2 includes only node `{2}`. The subset `{2}` is __ good. The score of this subset is 2.\n  * The `maxScore` array is `[8, 5, 2]`, and the sum of all values in `maxScore` is `8 + 5 + 2 = 15`. Thus, the answer is 15.\n\n\n\n**Example 3:**\n\n**Input:** vals = [34,1,2], par = [-1,0,1]\n\n**Output:** 42\n\n**Explanation:**\n\n![](https://assets.leetcode.com/uploads/2025/04/29/screenshot-2025-04-29-at-151747.png)\n\n  * The subtree rooted at node 0 includes nodes `{0, 1, 2}`. The subset `{34, 1, 2}` is __ good as the digits 3, 4, 1 and 2 appear only once. The score of this subset is `34 + 1 + 2 = 37`.\n  * The subtree rooted at node 1 includes node `{1, 2}`. The subset `{1, 2}` is __ good as the digits 1 and 2 appear only once. The score of this subset is `1 + 2 = 3`.\n  * The subtree rooted at node 2 includes only node `{2}`. The subset `{2}` is __ good. The score of this subset is 2.\n  * The `maxScore` array is `[37, 3, 2]`, and the sum of all values in `maxScore` is `37 + 3 + 2 = 42`. Thus, the answer is 42.\n\n\n\n**Example 4:**\n\n**Input:** vals = [3,22,5], par = [-1,0,1]\n\n**Output:** 18\n\n**Explanation:**\n\n  * The subtree rooted at node 0 includes nodes `{0, 1, 2}`. The subset `{3, 22, 5}` is __ not good, as digit 2 appears twice. Therefore, the subset `{3, 5}` is valid. The score of this subset is `3 + 5 = 8`.\n  * The subtree rooted at node 1 includes nodes `{1, 2}`. The subset `{22, 5}` is __ not good, as digit 2 appears twice. Therefore, the subset `{5}` is valid. The score of this subset is 5.\n  * The subtree rooted at node 2 includes `{2}`. The subset `{5}` is __ good. The score of this subset is 5.\n  * The `maxScore` array is `[8, 5, 5]`, and the sum of all values in `maxScore` is `8 + 5 + 5 = 18`. Thus, the answer is 18.",
  "constraints": "**Constraints:**\n\n  * `1 <= n == vals.length <= 500`\n  * `1 <= vals[i] <= 109`\n  * `par.length == n`\n  * `par[0] == -1`\n  * `0 <= par[i] < n` for `i` in `[1, n - 1]`\n  * The input is generated such that the parent array `par` represents a valid tree.",
  "topics": [
    "Array",
    "Dynamic Programming",
    "Bit Manipulation",
    "Tree",
    "Depth-First Search",
    "Bitmask"
  ],
  "total_accepted": 4659,
  "total_submissions": 10249,
  "acceptance_rate": "45.5%",
  "similar_questions": [],
  "hints": [
    "Use tree dynamic programming.",
    "Use bits (integer) to represent which digits are used."
  ]
}
