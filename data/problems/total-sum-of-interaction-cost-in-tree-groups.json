{
  "id": "3786",
  "title": "Total Sum of Interaction Cost in Tree Groups",
  "slug": "total-sum-of-interaction-cost-in-tree-groups",
  "difficulty": "Hard",
  "category": "Algorithms",
  "content_html": "<p>You are given an integer <code>n</code> and an undirected tree with <code>n</code> nodes numbered from 0 to <code>n - 1</code>. This is represented by a 2D array <code>edges</code> of length <code>n - 1</code>, where <code>edges[i] = [u<sub>i</sub>, v<sub>i</sub>]</code> indicates an undirected edge between nodes <code>u<sub>i</sub></code> and <code>v<sub>i</sub></code>.</p>\n\n<p>You are also given an integer array <code>group</code> of length <code>n</code>, where <code>group[i]</code> denotes the group label assigned to node <code>i</code>.</p>\n\n<ul>\n\t<li>Two nodes <code>u</code> and <code>v</code> are considered part of the same group if <code>group[u] == group[v]</code>.</li>\n\t<li>The <strong>interaction cost</strong> between <code>u</code> and <code>v</code> is defined as the number of edges on the unique path connecting them in the tree.</li>\n</ul>\n\n<p>Return an integer denoting the <strong>sum</strong> of interaction costs over all <strong>unordered</strong> pairs <code>(u, v)</code> with <code>u != v</code> such that <code>group[u] == group[v]</code>.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">n = 3, edges = [[0,1],[1,2]], group = [1,1,1]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">4</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p><strong class=\"example\"><img alt=\"\" src=\"https://assets.leetcode.com/uploads/2025/09/24/screenshot-2025-09-24-at-50538-pm.png\" style=\"width: 250px; height: 57px;\" /></strong></p>\n\n<p>All nodes belong to group 1. The interaction costs between the pairs of nodes are:</p>\n\n<ul>\n\t<li>Nodes <code>(0, 1)</code>: 1</li>\n\t<li>Nodes <code>(1, 2)</code>: 1</li>\n\t<li>Nodes <code>(0, 2)</code>: 2</li>\n</ul>\n\n<p>Thus, the total interaction cost is <code>1 + 1 + 2 = 4</code>.</p>\n</div>\n\n<p><strong class=\"example\">Example 2:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">n = 3, edges = [[0,1],[1,2]], group = [3,2,3]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">2</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>Nodes 0 and 2 belong to group 3. The interaction cost between this pair is 2.</li>\n\t<li>Node 1 belongs to a different group and forms no valid pair. Therefore, the total interaction cost is 2.</li>\n</ul>\n</div>\n\n<p><strong class=\"example\">Example 3:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">n = 4, edges = [[0,1],[0,2],[0,3]], group = [1,1,4,4]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">3</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p><img src=\"https://assets.leetcode.com/uploads/2025/09/24/screenshot-2025-09-24-at-51312-pm.png\" style=\"width: 200px; height: 146px;\" /></p>\n\n<p>Nodes belonging to the same groups and their interaction costs are:</p>\n\n<ul>\n\t<li>Group 1: Nodes <code>(0, 1)</code>: 1</li>\n\t<li>Group 4: Nodes <code>(2, 3)</code>: 2</li>\n</ul>\n\n<p>Thus, the total interaction cost is <code>1 + 2 = 3</code>.</p>\n</div>\n\n<p><strong class=\"example\">Example 4:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">n = 2, edges = [[0,1]], group = [9,8]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">0</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>All nodes belong to different groups and there are no valid pairs. Therefore, the total interaction cost is 0.</p>\n</div>\n\n<p>&nbsp;</p>\n<p><strong>Constraints:</strong></p>\n\n<ul>\n\t<li><code>1 &lt;= n &lt;= 10<sup>5</sup></code></li>\n\t<li><code>edges.length == n - 1</code></li>\n\t<li><code>edges[i] = [u<sub>i</sub>, v<sub>i</sub>]</code></li>\n\t<li><code>0 &lt;= u<sub>i</sub>, v<sub>i</sub> &lt;= n - 1</code></li>\n\t<li><code>group.length == n</code></li>\n\t<li><code>1 &lt;= group[i] &lt;= 20</code></li>\n\t<li>The input is generated such that <code>edges</code> represents a valid tree.</li>\n</ul>\n",
  "content_markdown": "You are given an integer `n` and an undirected tree with `n` nodes numbered from 0 to `n - 1`. This is represented by a 2D array `edges` of length `n - 1`, where `edges[i] = [ui, vi]` indicates an undirected edge between nodes `ui` and `vi`.\n\nYou are also given an integer array `group` of length `n`, where `group[i]` denotes the group label assigned to node `i`.\n\n  * Two nodes `u` and `v` are considered part of the same group if `group[u] == group[v]`.\n  * The **interaction cost** between `u` and `v` is defined as the number of edges on the unique path connecting them in the tree.\n\n\n\nReturn an integer denoting the **sum** of interaction costs over all **unordered** pairs `(u, v)` with `u != v` such that `group[u] == group[v]`.\n\n \n\n**Example 1:**\n\n**Input:** n = 3, edges = [[0,1],[1,2]], group = [1,1,1]\n\n**Output:** 4\n\n**Explanation:**\n\n**![](https://assets.leetcode.com/uploads/2025/09/24/screenshot-2025-09-24-at-50538-pm.png)**\n\nAll nodes belong to group 1. The interaction costs between the pairs of nodes are:\n\n  * Nodes `(0, 1)`: 1\n  * Nodes `(1, 2)`: 1\n  * Nodes `(0, 2)`: 2\n\n\n\nThus, the total interaction cost is `1 + 1 + 2 = 4`.\n\n**Example 2:**\n\n**Input:** n = 3, edges = [[0,1],[1,2]], group = [3,2,3]\n\n**Output:** 2\n\n**Explanation:**\n\n  * Nodes 0 and 2 belong to group 3. The interaction cost between this pair is 2.\n  * Node 1 belongs to a different group and forms no valid pair. Therefore, the total interaction cost is 2.\n\n\n\n**Example 3:**\n\n**Input:** n = 4, edges = [[0,1],[0,2],[0,3]], group = [1,1,4,4]\n\n**Output:** 3\n\n**Explanation:**\n\n![](https://assets.leetcode.com/uploads/2025/09/24/screenshot-2025-09-24-at-51312-pm.png)\n\nNodes belonging to the same groups and their interaction costs are:\n\n  * Group 1: Nodes `(0, 1)`: 1\n  * Group 4: Nodes `(2, 3)`: 2\n\n\n\nThus, the total interaction cost is `1 + 2 = 3`.\n\n**Example 4:**\n\n**Input:** n = 2, edges = [[0,1]], group = [9,8]\n\n**Output:** 0\n\n**Explanation:**\n\nAll nodes belong to different groups and there are no valid pairs. Therefore, the total interaction cost is 0.\n\n \n\n**Constraints:**\n\n  * `1 <= n <= 105`\n  * `edges.length == n - 1`\n  * `edges[i] = [ui, vi]`\n  * `0 <= ui, vi <= n - 1`\n  * `group.length == n`\n  * `1 <= group[i] <= 20`\n  * The input is generated such that `edges` represents a valid tree.",
  "question": "You are given an integer `n` and an undirected tree with `n` nodes numbered from 0 to `n - 1`. This is represented by a 2D array `edges` of length `n - 1`, where `edges[i] = [ui, vi]` indicates an undirected edge between nodes `ui` and `vi`.\n\nYou are also given an integer array `group` of length `n`, where `group[i]` denotes the group label assigned to node `i`.\n\n  * Two nodes `u` and `v` are considered part of the same group if `group[u] == group[v]`.\n  * The **interaction cost** between `u` and `v` is defined as the number of edges on the unique path connecting them in the tree.\n\n\n\nReturn an integer denoting the **sum** of interaction costs over all **unordered** pairs `(u, v)` with `u != v` such that `group[u] == group[v]`.",
  "examples": "**Example 1:**\n\n**Input:** n = 3, edges = [[0,1],[1,2]], group = [1,1,1]\n\n**Output:** 4\n\n**Explanation:**\n\n**![](https://assets.leetcode.com/uploads/2025/09/24/screenshot-2025-09-24-at-50538-pm.png)**\n\nAll nodes belong to group 1. The interaction costs between the pairs of nodes are:\n\n  * Nodes `(0, 1)`: 1\n  * Nodes `(1, 2)`: 1\n  * Nodes `(0, 2)`: 2\n\n\n\nThus, the total interaction cost is `1 + 1 + 2 = 4`.\n\n**Example 2:**\n\n**Input:** n = 3, edges = [[0,1],[1,2]], group = [3,2,3]\n\n**Output:** 2\n\n**Explanation:**\n\n  * Nodes 0 and 2 belong to group 3. The interaction cost between this pair is 2.\n  * Node 1 belongs to a different group and forms no valid pair. Therefore, the total interaction cost is 2.\n\n\n\n**Example 3:**\n\n**Input:** n = 4, edges = [[0,1],[0,2],[0,3]], group = [1,1,4,4]\n\n**Output:** 3\n\n**Explanation:**\n\n![](https://assets.leetcode.com/uploads/2025/09/24/screenshot-2025-09-24-at-51312-pm.png)\n\nNodes belonging to the same groups and their interaction costs are:\n\n  * Group 1: Nodes `(0, 1)`: 1\n  * Group 4: Nodes `(2, 3)`: 2\n\n\n\nThus, the total interaction cost is `1 + 2 = 3`.\n\n**Example 4:**\n\n**Input:** n = 2, edges = [[0,1]], group = [9,8]\n\n**Output:** 0\n\n**Explanation:**\n\nAll nodes belong to different groups and there are no valid pairs. Therefore, the total interaction cost is 0.",
  "constraints": "**Constraints:**\n\n  * `1 <= n <= 105`\n  * `edges.length == n - 1`\n  * `edges[i] = [ui, vi]`\n  * `0 <= ui, vi <= n - 1`\n  * `group.length == n`\n  * `1 <= group[i] <= 20`\n  * The input is generated such that `edges` represents a valid tree.",
  "topics": ["Array", "Tree", "Depth-First Search"],
  "total_accepted": 6997,
  "total_submissions": 13068,
  "acceptance_rate": "53.5%",
  "similar_questions": [],
  "hints": [
    "Do a postorder DFS, count how many nodes of each group are in each subtree.",
    "For each edge, contribution = <code>subtree_count * (total_count - subtree_count)</code>.",
    "Sum these over all edges and groups."
  ]
}
