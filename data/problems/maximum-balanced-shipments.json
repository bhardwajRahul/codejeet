{
  "id": "3638",
  "title": "Maximum Balanced Shipments",
  "slug": "maximum-balanced-shipments",
  "difficulty": "Medium",
  "category": "Algorithms",
  "content_html": "<p data-end=\"365\" data-start=\"23\">You are given an integer array <code data-end=\"62\" data-start=\"54\">weight</code> of length <code data-end=\"76\" data-start=\"73\">n</code>, representing the weights of <code data-end=\"109\" data-start=\"106\">n</code> parcels arranged in a straight line. A <strong data-end=\"161\" data-start=\"149\">shipment</strong> is defined as a contiguous subarray of parcels. A shipment is considered <strong data-end=\"247\" data-start=\"235\">balanced</strong> if the weight of the <strong data-end=\"284\" data-start=\"269\">last parcel</strong> is <strong>strictly less</strong> than the <strong data-end=\"329\" data-start=\"311\">maximum weight</strong> among all parcels in that shipment.</p>\n\n<p data-end=\"528\" data-start=\"371\">Select a set of <strong data-end=\"406\" data-start=\"387\">non-overlapping</strong>, contiguous, balanced shipments such that <strong data-end=\"496\" data-start=\"449\">each parcel appears in at most one shipment</strong> (parcels may remain unshipped).</p>\n\n<p data-end=\"587\" data-start=\"507\">Return the <strong data-end=\"545\" data-start=\"518\">maximum possible number</strong> of balanced shipments that can be formed.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">weight = [2,5,1,4,3]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">2</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p data-end=\"136\" data-start=\"62\">We can form the maximum of two balanced shipments as follows:</p>\n\n<ul>\n\t<li data-end=\"163\" data-start=\"140\">Shipment 1: <code>[2, 5, 1]</code>\n\n\t<ul>\n\t\t<li data-end=\"195\" data-start=\"168\">Maximum parcel weight = 5</li>\n\t\t<li data-end=\"275\" data-start=\"200\">Last parcel weight = 1, which is strictly less than 5. Thus, it&#39;s balanced.</li>\n\t</ul>\n\t</li>\n\t<li data-end=\"299\" data-start=\"279\">Shipment 2: <code>[4, 3]</code>\n\t<ul>\n\t\t<li data-end=\"331\" data-start=\"304\">Maximum parcel weight = 4</li>\n\t\t<li data-end=\"411\" data-start=\"336\">Last parcel weight = 3, which is strictly less than 4. Thus, it&#39;s balanced.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p data-end=\"519\" data-start=\"413\">It is impossible to partition the parcels to achieve more than two balanced shipments, so the answer is 2.</p>\n</div>\n\n<p><strong class=\"example\">Example 2:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">weight = [4,4]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">0</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p data-end=\"635\" data-start=\"574\">No balanced shipment can be formed in this case:</p>\n\n<ul>\n\t<li data-end=\"772\" data-start=\"639\">A shipment <code>[4, 4]</code> has maximum weight 4 and the last parcel&#39;s weight is also 4, which is not strictly less. Thus, it&#39;s not balanced.</li>\n\t<li data-end=\"885\" data-start=\"775\">Single-parcel shipments <code>[4]</code> have the last parcel weight equal to the maximum parcel weight, thus not balanced.</li>\n</ul>\n\n<p data-end=\"958\" data-is-last-node=\"\" data-is-only-node=\"\" data-start=\"887\">As there is no way to form even one balanced shipment, the answer is 0.</p>\n</div>\n\n<p>&nbsp;</p>\n<p><strong>Constraints:</strong></p>\n\n<ul>\n\t<li data-end=\"8706\" data-start=\"8671\"><code data-end=\"8704\" data-start=\"8671\">2 &lt;= n &lt;= 10<sup>5</sup></code></li>\n\t<li data-end=\"8733\" data-start=\"8709\"><code data-end=\"8733\" data-start=\"8709\">1 &lt;= weight[i] &lt;= 10<sup>9</sup></code></li>\n</ul>\n",
  "content_markdown": "You are given an integer array `weight` of length `n`, representing the weights of `n` parcels arranged in a straight line. A **shipment** is defined as a contiguous subarray of parcels. A shipment is considered **balanced** if the weight of the **last parcel** is **strictly less** than the **maximum weight** among all parcels in that shipment.\n\nSelect a set of **non-overlapping** , contiguous, balanced shipments such that **each parcel appears in at most one shipment** (parcels may remain unshipped).\n\nReturn the **maximum possible number** of balanced shipments that can be formed.\n\n \n\n**Example 1:**\n\n**Input:** weight = [2,5,1,4,3]\n\n**Output:** 2\n\n**Explanation:**\n\nWe can form the maximum of two balanced shipments as follows:\n\n  * Shipment 1: `[2, 5, 1]`\n    * Maximum parcel weight = 5\n    * Last parcel weight = 1, which is strictly less than 5. Thus, it's balanced.\n  * Shipment 2: `[4, 3]`\n    * Maximum parcel weight = 4\n    * Last parcel weight = 3, which is strictly less than 4. Thus, it's balanced.\n\n\n\nIt is impossible to partition the parcels to achieve more than two balanced shipments, so the answer is 2.\n\n**Example 2:**\n\n**Input:** weight = [4,4]\n\n**Output:** 0\n\n**Explanation:**\n\nNo balanced shipment can be formed in this case:\n\n  * A shipment `[4, 4]` has maximum weight 4 and the last parcel's weight is also 4, which is not strictly less. Thus, it's not balanced.\n  * Single-parcel shipments `[4]` have the last parcel weight equal to the maximum parcel weight, thus not balanced.\n\n\n\nAs there is no way to form even one balanced shipment, the answer is 0.\n\n \n\n**Constraints:**\n\n  * `2 <= n <= 105`\n  * `1 <= weight[i] <= 109`",
  "question": "You are given an integer array `weight` of length `n`, representing the weights of `n` parcels arranged in a straight line. A **shipment** is defined as a contiguous subarray of parcels. A shipment is considered **balanced** if the weight of the **last parcel** is **strictly less** than the **maximum weight** among all parcels in that shipment.\n\nSelect a set of **non-overlapping** , contiguous, balanced shipments such that **each parcel appears in at most one shipment** (parcels may remain unshipped).\n\nReturn the **maximum possible number** of balanced shipments that can be formed.",
  "examples": "**Example 1:**\n\n**Input:** weight = [2,5,1,4,3]\n\n**Output:** 2\n\n**Explanation:**\n\nWe can form the maximum of two balanced shipments as follows:\n\n  * Shipment 1: `[2, 5, 1]`\n    * Maximum parcel weight = 5\n    * Last parcel weight = 1, which is strictly less than 5. Thus, it's balanced.\n  * Shipment 2: `[4, 3]`\n    * Maximum parcel weight = 4\n    * Last parcel weight = 3, which is strictly less than 4. Thus, it's balanced.\n\n\n\nIt is impossible to partition the parcels to achieve more than two balanced shipments, so the answer is 2.\n\n**Example 2:**\n\n**Input:** weight = [4,4]\n\n**Output:** 0\n\n**Explanation:**\n\nNo balanced shipment can be formed in this case:\n\n  * A shipment `[4, 4]` has maximum weight 4 and the last parcel's weight is also 4, which is not strictly less. Thus, it's not balanced.\n  * Single-parcel shipments `[4]` have the last parcel weight equal to the maximum parcel weight, thus not balanced.\n\n\n\nAs there is no way to form even one balanced shipment, the answer is 0.",
  "constraints": "**Constraints:**\n\n  * `2 <= n <= 105`\n  * `1 <= weight[i] <= 109`",
  "topics": ["Array", "Dynamic Programming", "Stack", "Greedy", "Monotonic Stack"],
  "total_accepted": 51908,
  "total_submissions": 84664,
  "acceptance_rate": "61.3%",
  "similar_questions": [],
  "hints": [
    "Use a monotonic stack to find for each end index <code>i</code> the nearest previous index <code>j</code> with <code>weight[j] > weight[i]</code> (set <code>j = -1</code> if none).",
    "Then set <code>dp[i] = best[j] + 1</code> (using <code>best[-1] = 0</code>), and update <code>best[i] = max(best[i-1], dp[i])</code>; the result is <code>best[n-1]</code>."
  ]
}
