{
  "id": "3525",
  "title": "Find X Value of Array II",
  "slug": "find-x-value-of-array-ii",
  "difficulty": "Hard",
  "category": "Algorithms",
  "content_html": "<p>You are given an array of <strong>positive</strong> integers <code>nums</code> and a <strong>positive</strong> integer <code>k</code>. You are also given a 2D array <code>queries</code>, where <code>queries[i] = [index<sub>i</sub>, value<sub>i</sub>, start<sub>i</sub>, x<sub>i</sub>]</code>.</p>\n\n<p>You are allowed to perform an operation <strong>once</strong> on <code>nums</code>, where you can remove any <strong>suffix</strong> from <code>nums</code> such that <code>nums</code> remains <strong>non-empty</strong>.</p>\n\n<p>The <strong>x-value</strong> of <code>nums</code> <strong>for a given</strong> <code>x</code> is defined as the number of ways to perform this operation so that the <strong>product</strong> of the remaining elements leaves a <em>remainder</em> of <code>x</code> <strong>modulo</strong> <code>k</code>.</p>\n\n<p>For each query in <code>queries</code> you need to determine the <strong>x-value</strong> of <code>nums</code> for <code>x<sub>i</sub></code> after performing the following actions:</p>\n\n<ul>\n\t<li>Update <code>nums[index<sub>i</sub>]</code> to <code>value<sub>i</sub></code>. Only this step persists for the rest of the queries.</li>\n\t<li><strong>Remove</strong> the prefix <code>nums[0..(start<sub>i</sub> - 1)]</code> (where <code>nums[0..(-1)]</code> will be used to represent the <strong>empty</strong> prefix).</li>\n</ul>\n\n<p>Return an array <code>result</code> of size <code>queries.length</code> where <code>result[i]</code> is the answer for the <code>i<sup>th</sup></code> query.</p>\n\n<p>A <strong>prefix</strong> of an array is a <span data-keyword=\"subarray\">subarray</span> that starts from the beginning of the array and extends to any point within it.</p>\n\n<p>A <strong>suffix</strong> of an array is a <span data-keyword=\"subarray\">subarray</span> that starts at any point within the array and extends to the end of the array.</p>\n\n<p><strong>Note</strong> that the prefix and suffix to be chosen for the operation can be <strong>empty</strong>.</p>\n\n<p><strong>Note</strong> that x-value has a <em>different</em> definition in this version.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">nums = [1,2,3,4,5], k = 3, queries = [[2,2,0,2],[3,3,3,0],[0,1,0,1]]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">[2,2,2]</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>For query 0, <code>nums</code> becomes <code>[1, 2, 2, 4, 5]</code>, and the empty prefix <strong>must</strong> be removed. The possible operations are:\n\n\t<ul>\n\t\t<li>Remove the suffix <code>[2, 4, 5]</code>. <code>nums</code> becomes <code>[1, 2]</code>.</li>\n\t\t<li>Remove the empty suffix. <code>nums</code> becomes <code>[1, 2, 2, 4, 5]</code> with a product 80, which gives remainder 2 when divided by 3.</li>\n\t</ul>\n\t</li>\n\t<li>For query 1, <code>nums</code> becomes <code>[1, 2, 2, 3, 5]</code>, and the prefix <code>[1, 2, 2]</code> <strong>must</strong> be removed. The possible operations are:\n\t<ul>\n\t\t<li>Remove the empty suffix. <code>nums</code> becomes <code>[3, 5]</code>.</li>\n\t\t<li>Remove the suffix <code>[5]</code>. <code>nums</code> becomes <code>[3]</code>.</li>\n\t</ul>\n\t</li>\n\t<li>For query 2, <code>nums</code> becomes <code>[1, 2, 2, 3, 5]</code>, and the empty prefix <strong>must</strong> be removed. The possible operations are:\n\t<ul>\n\t\t<li>Remove the suffix <code>[2, 2, 3, 5]</code>. <code>nums</code> becomes <code>[1]</code>.</li>\n\t\t<li>Remove the suffix <code>[3, 5]</code>. <code>nums</code> becomes <code>[1, 2, 2]</code>.</li>\n\t</ul>\n\t</li>\n</ul>\n</div>\n\n<p><strong class=\"example\">Example 2:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">nums = [1,2,4,8,16,32], k = 4, queries = [[0,2,0,2],[0,2,0,1]]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">[1,0]</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>For query 0, <code>nums</code> becomes <code>[2, 2, 4, 8, 16, 32]</code>. The only possible operation is:\n\n\t<ul>\n\t\t<li>Remove the suffix <code>[2, 4, 8, 16, 32]</code>.</li>\n\t</ul>\n\t</li>\n\t<li>For query 1, <code>nums</code> becomes <code>[2, 2, 4, 8, 16, 32]</code>. There is no possible way to perform the operation.</li>\n</ul>\n</div>\n\n<p><strong class=\"example\">Example 3:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">nums = [1,1,2,1,1], k = 2, queries = [[2,1,0,1]]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">[5]</span></p>\n</div>\n\n<p>&nbsp;</p>\n<p><strong>Constraints:</strong></p>\n\n<ul>\n\t<li><code>1 &lt;= nums[i] &lt;= 10<sup>9</sup></code></li>\n\t<li><code>1 &lt;= nums.length &lt;= 10<sup>5</sup></code></li>\n\t<li><code>1 &lt;= k &lt;= 5</code></li>\n\t<li><code>1 &lt;= queries.length &lt;= 2 * 10<sup>4</sup></code></li>\n\t<li><code>queries[i] == [index<sub>i</sub>, value<sub>i</sub>, start<sub>i</sub>, x<sub>i</sub>]</code></li>\n\t<li><code>0 &lt;= index<sub>i</sub> &lt;= nums.length - 1</code></li>\n\t<li><code>1 &lt;= value<sub>i</sub> &lt;= 10<sup>9</sup></code></li>\n\t<li><code>0 &lt;= start<sub>i</sub> &lt;= nums.length - 1</code></li>\n\t<li><code>0 &lt;= x<sub>i</sub> &lt;= k - 1</code></li>\n</ul>\n",
  "content_markdown": "You are given an array of **positive** integers `nums` and a **positive** integer `k`. You are also given a 2D array `queries`, where `queries[i] = [indexi, valuei, starti, xi]`.\n\nYou are allowed to perform an operation **once** on `nums`, where you can remove any **suffix** from `nums` such that `nums` remains **non-empty**.\n\nThe **x-value** of `nums` **for a given** `x` is defined as the number of ways to perform this operation so that the **product** of the remaining elements leaves a _remainder_ of `x` **modulo** `k`.\n\nFor each query in `queries` you need to determine the **x-value** of `nums` for `xi` after performing the following actions:\n\n  * Update `nums[indexi]` to `valuei`. Only this step persists for the rest of the queries.\n  * **Remove** the prefix `nums[0..(starti - 1)]` (where `nums[0..(-1)]` will be used to represent the **empty** prefix).\n\n\n\nReturn an array `result` of size `queries.length` where `result[i]` is the answer for the `ith` query.\n\nA **prefix** of an array is a subarray that starts from the beginning of the array and extends to any point within it.\n\nA **suffix** of an array is a subarray that starts at any point within the array and extends to the end of the array.\n\n**Note** that the prefix and suffix to be chosen for the operation can be **empty**.\n\n**Note** that x-value has a _different_ definition in this version.\n\n \n\n**Example 1:**\n\n**Input:** nums = [1,2,3,4,5], k = 3, queries = [[2,2,0,2],[3,3,3,0],[0,1,0,1]]\n\n**Output:** [2,2,2]\n\n**Explanation:**\n\n  * For query 0, `nums` becomes `[1, 2, 2, 4, 5]`, and the empty prefix **must** be removed. The possible operations are: \n    * Remove the suffix `[2, 4, 5]`. `nums` becomes `[1, 2]`.\n    * Remove the empty suffix. `nums` becomes `[1, 2, 2, 4, 5]` with a product 80, which gives remainder 2 when divided by 3.\n  * For query 1, `nums` becomes `[1, 2, 2, 3, 5]`, and the prefix `[1, 2, 2]` **must** be removed. The possible operations are: \n    * Remove the empty suffix. `nums` becomes `[3, 5]`.\n    * Remove the suffix `[5]`. `nums` becomes `[3]`.\n  * For query 2, `nums` becomes `[1, 2, 2, 3, 5]`, and the empty prefix **must** be removed. The possible operations are: \n    * Remove the suffix `[2, 2, 3, 5]`. `nums` becomes `[1]`.\n    * Remove the suffix `[3, 5]`. `nums` becomes `[1, 2, 2]`.\n\n\n\n**Example 2:**\n\n**Input:** nums = [1,2,4,8,16,32], k = 4, queries = [[0,2,0,2],[0,2,0,1]]\n\n**Output:** [1,0]\n\n**Explanation:**\n\n  * For query 0, `nums` becomes `[2, 2, 4, 8, 16, 32]`. The only possible operation is: \n    * Remove the suffix `[2, 4, 8, 16, 32]`.\n  * For query 1, `nums` becomes `[2, 2, 4, 8, 16, 32]`. There is no possible way to perform the operation.\n\n\n\n**Example 3:**\n\n**Input:** nums = [1,1,2,1,1], k = 2, queries = [[2,1,0,1]]\n\n**Output:** [5]\n\n \n\n**Constraints:**\n\n  * `1 <= nums[i] <= 109`\n  * `1 <= nums.length <= 105`\n  * `1 <= k <= 5`\n  * `1 <= queries.length <= 2 * 104`\n  * `queries[i] == [indexi, valuei, starti, xi]`\n  * `0 <= indexi <= nums.length - 1`\n  * `1 <= valuei <= 109`\n  * `0 <= starti <= nums.length - 1`\n  * `0 <= xi <= k - 1`",
  "question": "You are given an array of **positive** integers `nums` and a **positive** integer `k`. You are also given a 2D array `queries`, where `queries[i] = [indexi, valuei, starti, xi]`.\n\nYou are allowed to perform an operation **once** on `nums`, where you can remove any **suffix** from `nums` such that `nums` remains **non-empty**.\n\nThe **x-value** of `nums` **for a given** `x` is defined as the number of ways to perform this operation so that the **product** of the remaining elements leaves a _remainder_ of `x` **modulo** `k`.\n\nFor each query in `queries` you need to determine the **x-value** of `nums` for `xi` after performing the following actions:\n\n  * Update `nums[indexi]` to `valuei`. Only this step persists for the rest of the queries.\n  * **Remove** the prefix `nums[0..(starti - 1)]` (where `nums[0..(-1)]` will be used to represent the **empty** prefix).\n\n\n\nReturn an array `result` of size `queries.length` where `result[i]` is the answer for the `ith` query.\n\nA **prefix** of an array is a subarray that starts from the beginning of the array and extends to any point within it.\n\nA **suffix** of an array is a subarray that starts at any point within the array and extends to the end of the array.\n\n**Note** that the prefix and suffix to be chosen for the operation can be **empty**.\n\n**Note** that x-value has a _different_ definition in this version.",
  "examples": "**Example 1:**\n\n**Input:** nums = [1,2,3,4,5], k = 3, queries = [[2,2,0,2],[3,3,3,0],[0,1,0,1]]\n\n**Output:** [2,2,2]\n\n**Explanation:**\n\n  * For query 0, `nums` becomes `[1, 2, 2, 4, 5]`, and the empty prefix **must** be removed. The possible operations are: \n    * Remove the suffix `[2, 4, 5]`. `nums` becomes `[1, 2]`.\n    * Remove the empty suffix. `nums` becomes `[1, 2, 2, 4, 5]` with a product 80, which gives remainder 2 when divided by 3.\n  * For query 1, `nums` becomes `[1, 2, 2, 3, 5]`, and the prefix `[1, 2, 2]` **must** be removed. The possible operations are: \n    * Remove the empty suffix. `nums` becomes `[3, 5]`.\n    * Remove the suffix `[5]`. `nums` becomes `[3]`.\n  * For query 2, `nums` becomes `[1, 2, 2, 3, 5]`, and the empty prefix **must** be removed. The possible operations are: \n    * Remove the suffix `[2, 2, 3, 5]`. `nums` becomes `[1]`.\n    * Remove the suffix `[3, 5]`. `nums` becomes `[1, 2, 2]`.\n\n\n\n**Example 2:**\n\n**Input:** nums = [1,2,4,8,16,32], k = 4, queries = [[0,2,0,2],[0,2,0,1]]\n\n**Output:** [1,0]\n\n**Explanation:**\n\n  * For query 0, `nums` becomes `[2, 2, 4, 8, 16, 32]`. The only possible operation is: \n    * Remove the suffix `[2, 4, 8, 16, 32]`.\n  * For query 1, `nums` becomes `[2, 2, 4, 8, 16, 32]`. There is no possible way to perform the operation.\n\n\n\n**Example 3:**\n\n**Input:** nums = [1,1,2,1,1], k = 2, queries = [[2,1,0,1]]\n\n**Output:** [5]",
  "constraints": "**Constraints:**\n\n  * `1 <= nums[i] <= 109`\n  * `1 <= nums.length <= 105`\n  * `1 <= k <= 5`\n  * `1 <= queries.length <= 2 * 104`\n  * `queries[i] == [indexi, valuei, starti, xi]`\n  * `0 <= indexi <= nums.length - 1`\n  * `1 <= valuei <= 109`\n  * `0 <= starti <= nums.length - 1`\n  * `0 <= xi <= k - 1`",
  "topics": ["Array", "Math", "Segment Tree"],
  "total_accepted": 3456,
  "total_submissions": 11315,
  "acceptance_rate": "30.5%",
  "similar_questions": [
    {
      "title": "Longest Uploaded Prefix",
      "slug": "longest-uploaded-prefix",
      "difficulty": "Medium",
      "url": "https://leetcode.com/problems/longest-uploaded-prefix/"
    },
    {
      "title": "Minimum Sum of Values by Dividing Array",
      "slug": "minimum-sum-of-values-by-dividing-array",
      "difficulty": "Hard",
      "url": "https://leetcode.com/problems/minimum-sum-of-values-by-dividing-array/"
    }
  ],
  "hints": [
    "Use a segment tree to efficiently maintain and merge product prefix information for the array <code>nums</code>.",
    "In each segment tree node, store a frequency count of prefix product remainders for every <code>x</code> in the range [0, k - 1].",
    "For each query, update <code>nums[index]</code> to <code>value</code>, then merge the segments corresponding to <code>nums[start..n - 1]</code> to compute the <code>x-value</code> for <code>xi</code>."
  ]
}
