{
  "id": "3605",
  "title": "Minimum Stability Factor of Array",
  "slug": "minimum-stability-factor-of-array",
  "difficulty": "Hard",
  "category": "Algorithms",
  "content_html": "<p>You are given an integer array <code>nums</code> and an integer <code>maxC</code>.</p>\n\n<p>A <strong><span data-keyword=\"subarray\">subarray</span></strong> is called <strong>stable</strong> if the <em>highest common factor (HCF)</em> of all its elements is <strong>greater than or equal to</strong> 2.</p>\n\n<p>The <strong>stability factor</strong> of an array is defined as the length of its <strong>longest</strong> stable subarray.</p>\n\n<p>You may modify <strong>at most</strong> <code>maxC</code> elements of the array to any integer.</p>\n\n<p>Return the <strong>minimum</strong> possible stability factor of the array after at most <code>maxC</code> modifications. If no stable subarray remains, return 0.</p>\n\n<p><strong>Note:</strong></p>\n\n<ul>\n\t<li>The <strong>highest common factor (HCF)</strong> of an array is the largest integer that evenly divides all the array elements.</li>\n\t<li>A <strong>subarray</strong> of length 1 is stable if its only element is greater than or equal to 2, since <code>HCF([x]) = x</code>.</li>\n</ul>\n\n<div class=\"notranslate\" style=\"all: initial;\"> </div>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">nums = [3,5,10], maxC = 1</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">1</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>The stable subarray <code>[5, 10]</code> has <code>HCF = 5</code>, which has a stability factor of 2.</li>\n\t<li>Since <code>maxC = 1</code>, one optimal strategy is to change <code>nums[1]</code> to <code>7</code>, resulting in <code>nums = [3, 7, 10]</code>.</li>\n\t<li>Now, no subarray of length greater than 1 has <code>HCF &gt;= 2</code>. Thus, the minimum possible stability factor is 1.</li>\n</ul>\n</div>\n\n<p><strong class=\"example\">Example 2:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">nums = [2,6,8], maxC = 2</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">1</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>The subarray <code>[2, 6, 8]</code> has <code>HCF = 2</code>, which has a stability factor of 3.</li>\n\t<li>Since <code>maxC = 2</code>, one optimal strategy is to change <code>nums[1]</code> to 3 and <code>nums[2]</code> to 5, resulting in <code>nums = [2, 3, 5]</code>.</li>\n\t<li>Now, no subarray of length greater than 1 has <code>HCF &gt;= 2</code>. Thus, the minimum possible stability factor is 1.</li>\n</ul>\n</div>\n\n<p><strong class=\"example\">Example 3:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">nums = [2,4,9,6], maxC = 1</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">2</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>The stable subarrays are:\n\t<ul>\n\t\t<li><code>[2, 4]</code> with <code>HCF = 2</code> and stability factor of 2.</li>\n\t\t<li><code>[9, 6]</code> with <code>HCF = 3</code> and stability factor of 2.</li>\n\t</ul>\n\t</li>\n\t<li>Since <code>maxC = 1</code>, the stability factor of 2 cannot be reduced due to two separate stable subarrays. Thus, the minimum possible stability factor is 2.</li>\n</ul>\n</div>\n\n<p>&nbsp;</p>\n<p><strong>Constraints:</strong></p>\n\n<ul>\n\t<li><code>1 &lt;= n == nums.length &lt;= 10<sup>5</sup></code></li>\n\t<li><code>1 &lt;= nums[i] &lt;= 10<sup>9</sup></code></li>\n\t<li><code>0 &lt;= maxC &lt;= n</code></li>\n</ul>\n",
  "content_markdown": "You are given an integer array `nums` and an integer `maxC`.\n\nA **subarray** is called **stable** if the _highest common factor (HCF)_ of all its elements is **greater than or equal to** 2.\n\nThe **stability factor** of an array is defined as the length of its **longest** stable subarray.\n\nYou may modify **at most** `maxC` elements of the array to any integer.\n\nReturn the **minimum** possible stability factor of the array after at most `maxC` modifications. If no stable subarray remains, return 0.\n\n**Note:**\n\n  * The **highest common factor (HCF)** of an array is the largest integer that evenly divides all the array elements.\n  * A **subarray** of length 1 is stable if its only element is greater than or equal to 2, since `HCF([x]) = x`.\n\n\n\n \n\n**Example 1:**\n\n**Input:** nums = [3,5,10], maxC = 1\n\n**Output:** 1\n\n**Explanation:**\n\n  * The stable subarray `[5, 10]` has `HCF = 5`, which has a stability factor of 2.\n  * Since `maxC = 1`, one optimal strategy is to change `nums[1]` to `7`, resulting in `nums = [3, 7, 10]`.\n  * Now, no subarray of length greater than 1 has `HCF >= 2`. Thus, the minimum possible stability factor is 1.\n\n\n\n**Example 2:**\n\n**Input:** nums = [2,6,8], maxC = 2\n\n**Output:** 1\n\n**Explanation:**\n\n  * The subarray `[2, 6, 8]` has `HCF = 2`, which has a stability factor of 3.\n  * Since `maxC = 2`, one optimal strategy is to change `nums[1]` to 3 and `nums[2]` to 5, resulting in `nums = [2, 3, 5]`.\n  * Now, no subarray of length greater than 1 has `HCF >= 2`. Thus, the minimum possible stability factor is 1.\n\n\n\n**Example 3:**\n\n**Input:** nums = [2,4,9,6], maxC = 1\n\n**Output:** 2\n\n**Explanation:**\n\n  * The stable subarrays are: \n    * `[2, 4]` with `HCF = 2` and stability factor of 2.\n    * `[9, 6]` with `HCF = 3` and stability factor of 2.\n  * Since `maxC = 1`, the stability factor of 2 cannot be reduced due to two separate stable subarrays. Thus, the minimum possible stability factor is 2.\n\n\n\n \n\n**Constraints:**\n\n  * `1 <= n == nums.length <= 105`\n  * `1 <= nums[i] <= 109`\n  * `0 <= maxC <= n`",
  "question": "You are given an integer array `nums` and an integer `maxC`.\n\nA **subarray** is called **stable** if the _highest common factor (HCF)_ of all its elements is **greater than or equal to** 2.\n\nThe **stability factor** of an array is defined as the length of its **longest** stable subarray.\n\nYou may modify **at most** `maxC` elements of the array to any integer.\n\nReturn the **minimum** possible stability factor of the array after at most `maxC` modifications. If no stable subarray remains, return 0.\n\n**Note:**\n\n  * The **highest common factor (HCF)** of an array is the largest integer that evenly divides all the array elements.\n  * A **subarray** of length 1 is stable if its only element is greater than or equal to 2, since `HCF([x]) = x`.",
  "examples": "**Example 1:**\n\n**Input:** nums = [3,5,10], maxC = 1\n\n**Output:** 1\n\n**Explanation:**\n\n  * The stable subarray `[5, 10]` has `HCF = 5`, which has a stability factor of 2.\n  * Since `maxC = 1`, one optimal strategy is to change `nums[1]` to `7`, resulting in `nums = [3, 7, 10]`.\n  * Now, no subarray of length greater than 1 has `HCF >= 2`. Thus, the minimum possible stability factor is 1.\n\n\n\n**Example 2:**\n\n**Input:** nums = [2,6,8], maxC = 2\n\n**Output:** 1\n\n**Explanation:**\n\n  * The subarray `[2, 6, 8]` has `HCF = 2`, which has a stability factor of 3.\n  * Since `maxC = 2`, one optimal strategy is to change `nums[1]` to 3 and `nums[2]` to 5, resulting in `nums = [2, 3, 5]`.\n  * Now, no subarray of length greater than 1 has `HCF >= 2`. Thus, the minimum possible stability factor is 1.\n\n\n\n**Example 3:**\n\n**Input:** nums = [2,4,9,6], maxC = 1\n\n**Output:** 2\n\n**Explanation:**\n\n  * The stable subarrays are: \n    * `[2, 4]` with `HCF = 2` and stability factor of 2.\n    * `[9, 6]` with `HCF = 3` and stability factor of 2.\n  * Since `maxC = 1`, the stability factor of 2 cannot be reduced due to two separate stable subarrays. Thus, the minimum possible stability factor is 2.",
  "constraints": "**Constraints:**\n\n  * `1 <= n == nums.length <= 105`\n  * `1 <= nums[i] <= 109`\n  * `0 <= maxC <= n`",
  "topics": ["Array", "Math", "Binary Search", "Greedy", "Segment Tree", "Number Theory"],
  "total_accepted": 3971,
  "total_submissions": 19599,
  "acceptance_rate": "20.3%",
  "similar_questions": [],
  "hints": [
    "Binary‐search the target length <code>k</code>",
    "For each <code>k</code>, use fast range‐GCD queries",
    "Greedily \"hit\" every window of size <code>k+1</code> with an edit if its <code>GCD > 1</code>"
  ]
}
